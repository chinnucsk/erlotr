-define(MessageTestVector1, { %F{{{
"?OTR:AAICAAAAxKYGF72ZVsmdDeBOjUH9RMBynsVZFRSiL922gxBCJzUwRX/y/xL/aB5IB21lG8ranuJc8gzAenPNpYkrBLx4a2Pvfj9XXd8G34/FH7zej6vTu0lvcUDtj5ebRIfZnbCX2fErnHrz9KhyK4dWLiGG357p+fx8qFew7NpPRVG5naaWH2Jp4FitdpxOt7tzGNF8QDfPJqYZRKbbERpgH0yWUgPv+TuYQQciWBf+9eYD4ezk5VctCRX5rjjXlBfyj30h0IM48lgAAAAgaY0TR6m1KGTvdY0/YTtEC4HpC+Ud5eMu35e6aIC8bLQ=.",
#otr_msg_dh_commit{ 
enc_gx = << 16#a6, 16#06, 16#17, 16#bd, 16#99, 16#56, 16#c9, 16#9d, 16#0d, 16#e0, 16#4e, 16#8d, 16#41, 16#fd, 16#44, 16#c0, 16#72, 16#9e, 16#c5, 16#59, 16#15, 16#14, 16#a2, 16#2f, 16#dd, 16#b6, 16#83, 16#10, 16#42, 16#27, 16#35, 16#30, 16#45, 16#7f, 16#f2, 16#ff, 16#12, 16#ff, 16#68, 16#1e, 16#48, 16#07, 16#6d, 16#65, 16#1b, 16#ca, 16#da, 16#9e, 16#e2, 16#5c, 16#f2, 16#0c, 16#c0, 16#7a, 16#73, 16#cd, 16#a5, 16#89, 16#2b, 16#04, 16#bc, 16#78, 16#6b, 16#63, 16#ef, 16#7e, 16#3f, 16#57, 16#5d, 16#df, 16#06, 16#df, 16#8f, 16#c5, 16#1f, 16#bc, 16#de, 16#8f, 16#ab, 16#d3, 16#bb, 16#49, 16#6f, 16#71, 16#40, 16#ed, 16#8f, 16#97, 16#9b, 16#44, 16#87, 16#d9, 16#9d, 16#b0, 16#97, 16#d9, 16#f1, 16#2b, 16#9c, 16#7a, 16#f3, 16#f4, 16#a8, 16#72, 16#2b, 16#87, 16#56, 16#2e, 16#21, 16#86, 16#df, 16#9e, 16#e9, 16#f9, 16#fc, 16#7c, 16#a8, 16#57, 16#b0, 16#ec, 16#da, 16#4f, 16#45, 16#51, 16#b9, 16#9d, 16#a6, 16#96, 16#1f, 16#62, 16#69, 16#e0, 16#58, 16#ad, 16#76, 16#9c, 16#4e, 16#b7, 16#bb, 16#73, 16#18, 16#d1, 16#7c, 16#40, 16#37, 16#cf, 16#26, 16#a6, 16#19, 16#44, 16#a6, 16#db, 16#11, 16#1a, 16#60, 16#1f, 16#4c, 16#96, 16#52, 16#03, 16#ef, 16#f9, 16#3b, 16#98, 16#41, 16#07, 16#22, 16#58, 16#17, 16#fe, 16#f5, 16#e6, 16#03, 16#e1, 16#ec, 16#e4, 16#e5, 16#57, 16#2d, 16#09, 16#15, 16#f9, 16#ae, 16#38, 16#d7, 16#94, 16#17, 16#f2, 16#8f, 16#7d, 16#21, 16#d0, 16#83, 16#38, 16#f2, 16#58>>,
hash_gx = << 16#69, 16#8d, 16#13, 16#47, 16#a9, 16#b5, 16#28, 16#64, 16#ef, 16#75, 16#8d, 16#3f, 16#61, 16#3b, 16#44, 16#0b, 16#81, 16#e9, 16#0b, 16#e5, 16#1d, 16#e5, 16#e3, 16#2e, 16#df, 16#97, 16#ba, 16#68, 16#80, 16#bc, 16#6c, 16#b4>>
}
}). %}}}F

-define(MessageTestVector2, { %F{{{
"?OTR:AAIKAAAAwBTTIrYsCv0ncRSvwWO1W8WeRQb0Q8q2xgCfKF1Py9edDmGnrn0n0z7mQSo/fmAiOST/W1HJ2Prcfc32IvsOSYvFWv740M+2unT5U3hpD1/1h3r7Y7qmaxWM17lUOo7HUCK6RySjbdeWYMKyBuwxjGb3eNzbN1EN3DdGmTOlUbrRqBUQV/YW4FhT4pEFHXQcZF67UkkBKNijxDcCOTrMvSF9DpEwdOI7bAN3l6j+EZ6POb5MzwDfUyf9NvnsdJGvdQ==.",
#otr_msg_dh_key{gy = 16#14d322b62c0afd277114afc163b55bc59e4506f443cab6c6009f285d4fcbd79d0e61a7ae7d27d33ee6412a3f7e60223924ff5b51c9d8fadc7dcdf622fb0e498bc55afef8d0cfb6ba74f95378690f5ff5877afb63baa66b158cd7b9543a8ec75022ba4724a36dd79660c2b206ec318c66f778dcdb37510ddc37469933a551bad1a8151057f616e05853e291051d741c645ebb52490128d8a3c43702393accbd217d0e913074e23b6c037797a8fe119e8f39be4ccf00df5327fd36f9ec7491af75}
}). %}}}F

-define(MessageTestVector3, { %F{{{
"?OTR:AAIRAAAAEKvaePdt1HaLW03QsQDDT90AAAHSKN4kahbuAvtvfV/BRIUkTtI+f23u08htJjQo967O59VoI7O/KD+BaFdEzVSm6ojpCBMtqPIViO60zg8J7/3szSTFuNnE0c4JVJzqtlkyKOtWBWe6EW8j21A+n11NM/+tC7SxdFnYedAOSNl71v6I8DufMDorOmfgIlX97Bk/Irn+8Q7sdUkTew5adVA3jhtp3RIk3iaTS2gyusYvTit8hXMXnb7lEXIl7tQTboLZBtLRdjtvK4C7xAI5EGkfOcihBUL+cWYTnTA72MnLhP82DloBQvQTeKbZxU6xX/AI4AhN3OTA9qYm6d6YQsLUXGkVHY2pVdKSOPiVPbmKfi7Zu+XqmD/2+cJCuO//CDafPy2BLfYe4YwrIrPIab0xUP5EdhDy81WO+Yh/+DyRLToSZEnzHE7jJyvStTZS1MR+hd7QLEu1xDXf5NCIyN9fJksroqxyfmZNA49GE8MwxdOFvT/lvHCXONZvJWTf9+Ph3mTbPddtxtAcFnSJRBZSF0SOWrHLXk7sCPvFyuyAZyikkyL5l9xx9pO7SdKNl780Ta0Hlt6utRalEyD0hfT1gY6HWTos7ubk4miks7r2ZfLQVdb9i9jUDFCunhqyypgnhfJFBybF3i0LS5Ngc9cRua0IOEy/fX/h.",
#otr_msg_reveal_signature{
r = << 16#ab, 16#da, 16#78, 16#f7, 16#6d, 16#d4, 16#76, 16#8b, 16#5b, 16#4d, 16#d0, 16#b1, 16#00, 16#c3, 16#4f, 16#dd>>,
enc_sig = << 16#28, 16#de, 16#24, 16#6a, 16#16, 16#ee, 16#02, 16#fb, 16#6f, 16#7d, 16#5f, 16#c1, 16#44, 16#85, 16#24, 16#4e, 16#d2, 16#3e, 16#7f, 16#6d, 16#ee, 16#d3, 16#c8, 16#6d, 16#26, 16#34, 16#28, 16#f7, 16#ae, 16#ce, 16#e7, 16#d5, 16#68, 16#23, 16#b3, 16#bf, 16#28, 16#3f, 16#81, 16#68, 16#57, 16#44, 16#cd, 16#54, 16#a6, 16#ea, 16#88, 16#e9, 16#08, 16#13, 16#2d, 16#a8, 16#f2, 16#15, 16#88, 16#ee, 16#b4, 16#ce, 16#0f, 16#09, 16#ef, 16#fd, 16#ec, 16#cd, 16#24, 16#c5, 16#b8, 16#d9, 16#c4, 16#d1, 16#ce, 16#09, 16#54, 16#9c, 16#ea, 16#b6, 16#59, 16#32, 16#28, 16#eb, 16#56, 16#05, 16#67, 16#ba, 16#11, 16#6f, 16#23, 16#db, 16#50, 16#3e, 16#9f, 16#5d, 16#4d, 16#33, 16#ff, 16#ad, 16#0b, 16#b4, 16#b1, 16#74, 16#59, 16#d8, 16#79, 16#d0, 16#0e, 16#48, 16#d9, 16#7b, 16#d6, 16#fe, 16#88, 16#f0, 16#3b, 16#9f, 16#30, 16#3a, 16#2b, 16#3a, 16#67, 16#e0, 16#22, 16#55, 16#fd, 16#ec, 16#19, 16#3f, 16#22, 16#b9, 16#fe, 16#f1, 16#0e, 16#ec, 16#75, 16#49, 16#13, 16#7b, 16#0e, 16#5a, 16#75, 16#50, 16#37, 16#8e, 16#1b, 16#69, 16#dd, 16#12, 16#24, 16#de, 16#26, 16#93, 16#4b, 16#68, 16#32, 16#ba, 16#c6, 16#2f, 16#4e, 16#2b, 16#7c, 16#85, 16#73, 16#17, 16#9d, 16#be, 16#e5, 16#11, 16#72, 16#25, 16#ee, 16#d4, 16#13, 16#6e, 16#82, 16#d9, 16#06, 16#d2, 16#d1, 16#76, 16#3b, 16#6f, 16#2b, 16#80, 16#bb, 16#c4, 16#02, 16#39, 16#10, 16#69, 16#1f, 16#39, 16#c8, 16#a1, 16#05, 16#42, 16#fe, 16#71, 16#66, 16#13, 16#9d, 16#30, 16#3b, 16#d8, 16#c9, 16#cb, 16#84, 16#ff, 16#36, 16#0e, 16#5a, 16#01, 16#42, 16#f4, 16#13, 16#78, 16#a6, 16#d9, 16#c5, 16#4e, 16#b1, 16#5f, 16#f0, 16#08, 16#e0, 16#08, 16#4d, 16#dc, 16#e4, 16#c0, 16#f6, 16#a6, 16#26, 16#e9, 16#de, 16#98, 16#42, 16#c2, 16#d4, 16#5c, 16#69, 16#15, 16#1d, 16#8d, 16#a9, 16#55, 16#d2, 16#92, 16#38, 16#f8, 16#95, 16#3d, 16#b9, 16#8a, 16#7e, 16#2e, 16#d9, 16#bb, 16#e5, 16#ea, 16#98, 16#3f, 16#f6, 16#f9, 16#c2, 16#42, 16#b8, 16#ef, 16#ff, 16#08, 16#36, 16#9f, 16#3f, 16#2d, 16#81, 16#2d, 16#f6, 16#1e, 16#e1, 16#8c, 16#2b, 16#22, 16#b3, 16#c8, 16#69, 16#bd, 16#31, 16#50, 16#fe, 16#44, 16#76, 16#10, 16#f2, 16#f3, 16#55, 16#8e, 16#f9, 16#88, 16#7f, 16#f8, 16#3c, 16#91, 16#2d, 16#3a, 16#12, 16#64, 16#49, 16#f3, 16#1c, 16#4e, 16#e3, 16#27, 16#2b, 16#d2, 16#b5, 16#36, 16#52, 16#d4, 16#c4, 16#7e, 16#85, 16#de, 16#d0, 16#2c, 16#4b, 16#b5, 16#c4, 16#35, 16#df, 16#e4, 16#d0, 16#88, 16#c8, 16#df, 16#5f, 16#26, 16#4b, 16#2b, 16#a2, 16#ac, 16#72, 16#7e, 16#66, 16#4d, 16#03, 16#8f, 16#46, 16#13, 16#c3, 16#30, 16#c5, 16#d3, 16#85, 16#bd, 16#3f, 16#e5, 16#bc, 16#70, 16#97, 16#38, 16#d6, 16#6f, 16#25, 16#64, 16#df, 16#f7, 16#e3, 16#e1, 16#de, 16#64, 16#db, 16#3d, 16#d7, 16#6d, 16#c6, 16#d0, 16#1c, 16#16, 16#74, 16#89, 16#44, 16#16, 16#52, 16#17, 16#44, 16#8e, 16#5a, 16#b1, 16#cb, 16#5e, 16#4e, 16#ec, 16#08, 16#fb, 16#c5, 16#ca, 16#ec, 16#80, 16#67, 16#28, 16#a4, 16#93, 16#22, 16#f9, 16#97, 16#dc, 16#71, 16#f6, 16#93, 16#bb, 16#49, 16#d2, 16#8d, 16#97, 16#bf, 16#34, 16#4d, 16#ad, 16#07, 16#96, 16#de, 16#ae, 16#b5, 16#16, 16#a5, 16#13, 16#20, 16#f4, 16#85, 16#f4, 16#f5, 16#81, 16#8e, 16#87, 16#59, 16#3a, 16#2c, 16#ee, 16#e6, 16#e4, 16#e2, 16#68, 16#a4, 16#b3, 16#ba, 16#f6, 16#65, 16#f2, 16#d0, 16#55, 16#d6, 16#fd, 16#8b, 16#d8, 16#d4, 16#0c, 16#50, 16#ae, 16#9e, 16#1a, 16#b2, 16#ca, 16#98, 16#27, 16#85, 16#f2, 16#45, 16#07>>,
mac = << 16#26, 16#c5, 16#de, 16#2d, 16#0b, 16#4b, 16#93, 16#60, 16#73, 16#d7, 16#11, 16#b9, 16#ad, 16#08, 16#38, 16#4c, 16#bf, 16#7d, 16#7f, 16#e1>>
}
}). %}}}F

-define(MessageTestVector4, { %F{{{
"?OTR:AAISAAAB0iYAwRHWYI/H0p70tF4bPsPRTygW9tHcTAllLjhXj0JzwI1z+fq4tP1Cu7ganVJYk7umyJwjPDc7zECABROWhZPJSo9pDIbW9ximaCygpsAJUxYzmWYGSlOYiB8cCkB8ycRcsMarh+0YivBOjy4BS8fZ4YOJDHxJ4Uh9XfFF9lyOCU8ywqH4re4tdgkNG/8zKgdAY3YwALUgNsqpQpdCRRxOpSC/FyfdLBSX7mY3C7aBqRvecdkhVrQ5FkOYKdMJya0+3OPnDEfZ5Qt/zdUT2Y9ko1W3se+3pExiIDny8c52nqjqcMvH4A9w0FnANRz+2iVhFa0g0WnZUdZrmR8n4wqYOrU7fN56k+zDagD9E/CHAFUwgotQOxY6QOUdWWT9NyYcwGUOXfzlGjHNWDF1D080pXIBvrNSKi3R/HtUl0+KXJ44uR6wWWVhVwtu5XlMUlJums/M/pUrgEkTXoUGc7E4U9DZNJDvh+uzKusKwcWK0tZqeN07a4HHoNHcU0u4nMsAAF6rGX1sfXtQpKePSGmWcEJgmp+HfpxKjNxp7lH+NwicRARWGp0B4A0m7DYfUi3vb113zWHzk5blYj8Vu4vaNDt9vVhXSiEsJhz12doEyGQQHBe+eQbRwWgaseSgLwrYiojJdA==.",
#otr_msg_signature{
enc_sig = << 16#26, 16#00, 16#c1, 16#11, 16#d6, 16#60, 16#8f, 16#c7, 16#d2, 16#9e, 16#f4, 16#b4, 16#5e, 16#1b, 16#3e, 16#c3, 16#d1, 16#4f, 16#28, 16#16, 16#f6, 16#d1, 16#dc, 16#4c, 16#09, 16#65, 16#2e, 16#38, 16#57, 16#8f, 16#42, 16#73, 16#c0, 16#8d, 16#73, 16#f9, 16#fa, 16#b8, 16#b4, 16#fd, 16#42, 16#bb, 16#b8, 16#1a, 16#9d, 16#52, 16#58, 16#93, 16#bb, 16#a6, 16#c8, 16#9c, 16#23, 16#3c, 16#37, 16#3b, 16#cc, 16#40, 16#80, 16#05, 16#13, 16#96, 16#85, 16#93, 16#c9, 16#4a, 16#8f, 16#69, 16#0c, 16#86, 16#d6, 16#f7, 16#18, 16#a6, 16#68, 16#2c, 16#a0, 16#a6, 16#c0, 16#09, 16#53, 16#16, 16#33, 16#99, 16#66, 16#06, 16#4a, 16#53, 16#98, 16#88, 16#1f, 16#1c, 16#0a, 16#40, 16#7c, 16#c9, 16#c4, 16#5c, 16#b0, 16#c6, 16#ab, 16#87, 16#ed, 16#18, 16#8a, 16#f0, 16#4e, 16#8f, 16#2e, 16#01, 16#4b, 16#c7, 16#d9, 16#e1, 16#83, 16#89, 16#0c, 16#7c, 16#49, 16#e1, 16#48, 16#7d, 16#5d, 16#f1, 16#45, 16#f6, 16#5c, 16#8e, 16#09, 16#4f, 16#32, 16#c2, 16#a1, 16#f8, 16#ad, 16#ee, 16#2d, 16#76, 16#09, 16#0d, 16#1b, 16#ff, 16#33, 16#2a, 16#07, 16#40, 16#63, 16#76, 16#30, 16#00, 16#b5, 16#20, 16#36, 16#ca, 16#a9, 16#42, 16#97, 16#42, 16#45, 16#1c, 16#4e, 16#a5, 16#20, 16#bf, 16#17, 16#27, 16#dd, 16#2c, 16#14, 16#97, 16#ee, 16#66, 16#37, 16#0b, 16#b6, 16#81, 16#a9, 16#1b, 16#de, 16#71, 16#d9, 16#21, 16#56, 16#b4, 16#39, 16#16, 16#43, 16#98, 16#29, 16#d3, 16#09, 16#c9, 16#ad, 16#3e, 16#dc, 16#e3, 16#e7, 16#0c, 16#47, 16#d9, 16#e5, 16#0b, 16#7f, 16#cd, 16#d5, 16#13, 16#d9, 16#8f, 16#64, 16#a3, 16#55, 16#b7, 16#b1, 16#ef, 16#b7, 16#a4, 16#4c, 16#62, 16#20, 16#39, 16#f2, 16#f1, 16#ce, 16#76, 16#9e, 16#a8, 16#ea, 16#70, 16#cb, 16#c7, 16#e0, 16#0f, 16#70, 16#d0, 16#59, 16#c0, 16#35, 16#1c, 16#fe, 16#da, 16#25, 16#61, 16#15, 16#ad, 16#20, 16#d1, 16#69, 16#d9, 16#51, 16#d6, 16#6b, 16#99, 16#1f, 16#27, 16#e3, 16#0a, 16#98, 16#3a, 16#b5, 16#3b, 16#7c, 16#de, 16#7a, 16#93, 16#ec, 16#c3, 16#6a, 16#00, 16#fd, 16#13, 16#f0, 16#87, 16#00, 16#55, 16#30, 16#82, 16#8b, 16#50, 16#3b, 16#16, 16#3a, 16#40, 16#e5, 16#1d, 16#59, 16#64, 16#fd, 16#37, 16#26, 16#1c, 16#c0, 16#65, 16#0e, 16#5d, 16#fc, 16#e5, 16#1a, 16#31, 16#cd, 16#58, 16#31, 16#75, 16#0f, 16#4f, 16#34, 16#a5, 16#72, 16#01, 16#be, 16#b3, 16#52, 16#2a, 16#2d, 16#d1, 16#fc, 16#7b, 16#54, 16#97, 16#4f, 16#8a, 16#5c, 16#9e, 16#38, 16#b9, 16#1e, 16#b0, 16#59, 16#65, 16#61, 16#57, 16#0b, 16#6e, 16#e5, 16#79, 16#4c, 16#52, 16#52, 16#6e, 16#9a, 16#cf, 16#cc, 16#fe, 16#95, 16#2b, 16#80, 16#49, 16#13, 16#5e, 16#85, 16#06, 16#73, 16#b1, 16#38, 16#53, 16#d0, 16#d9, 16#34, 16#90, 16#ef, 16#87, 16#eb, 16#b3, 16#2a, 16#eb, 16#0a, 16#c1, 16#c5, 16#8a, 16#d2, 16#d6, 16#6a, 16#78, 16#dd, 16#3b, 16#6b, 16#81, 16#c7, 16#a0, 16#d1, 16#dc, 16#53, 16#4b, 16#b8, 16#9c, 16#cb, 16#00, 16#00, 16#5e, 16#ab, 16#19, 16#7d, 16#6c, 16#7d, 16#7b, 16#50, 16#a4, 16#a7, 16#8f, 16#48, 16#69, 16#96, 16#70, 16#42, 16#60, 16#9a, 16#9f, 16#87, 16#7e, 16#9c, 16#4a, 16#8c, 16#dc, 16#69, 16#ee, 16#51, 16#fe, 16#37, 16#08, 16#9c, 16#44, 16#04, 16#56, 16#1a, 16#9d, 16#01, 16#e0, 16#0d, 16#26, 16#ec, 16#36, 16#1f, 16#52, 16#2d, 16#ef, 16#6f, 16#5d, 16#77, 16#cd, 16#61, 16#f3, 16#93, 16#96, 16#e5, 16#62, 16#3f, 16#15, 16#bb, 16#8b, 16#da, 16#34, 16#3b, 16#7d, 16#bd, 16#58, 16#57, 16#4a, 16#21, 16#2c, 16#26, 16#1c, 16#f5, 16#d9, 16#da, 16#04, 16#c8, 16#64>>,
mac = << 16#10, 16#1c, 16#17, 16#be, 16#79, 16#06, 16#d1, 16#c1, 16#68, 16#1a, 16#b1, 16#e4, 16#a0, 16#2f, 16#0a, 16#d8, 16#8a, 16#88, 16#c9, 16#74>>
}
}). %}}}F

-define(MessageTestVector5, { %F{{{
"?OTR:AAIDAAAAAAEAAAABAAAAwLYJ1/yLWVzkFKC2RNEbHgVH1l5gFEMI2X0C065HfB/6p3jeBBZh/pUEQN5UcXfrVVYN3eqbs4gETVSywfpu9hd3czfqRQhrHCt2TZah1YzHeIdDldkqsICZ8wJhWeMxlhDchafwslJ77osx0Y5MZHw30nfslu+LBM/s93aICN6xXG9oykZFqAiURdDPiVody9LYRCkHvFtAesT8wLrhAg2e/SSju7lq/LaYHFNufsgJCAqVlAVCxDtF44Ph79FaKQAAAAAAAAABAAABBsgPessNDTyhhFxkInR+ZZ8YopqyzRlWrcDhZz6GajxbF+OhiHrkH9FE6zdHlLoTZ79gknoofbhwkqYrdPoPsBRWQH0PjSb+Bn+CKdOWkUKbuQTGAZqOE34yIQ695J86zdzuo0Y6BtyVWsxSNqfsrQm90HIjB147v3z5b8/Sy1pdMyc1OcP7qngfaO8BSpeW2kSMNofYsWMrJsH1SM6Wvd2F5FMOVP16BJ7rY7r1odYcHmlpU0JMrQgAXBLTrE+ouhDMQOHI9ZVbC3aIJcrfmaS3rvtON5MH4bQNZtGzJOZDJK5HkAVCtWGivh/Yslax26vSeyEQruIO2UWLE5UD049x5G8SW8D5G4er3ViLiKOJyOfZYt2nA7ilTAAAAAA=.",
#otr_msg_data{flags = 0, sender_keyid = 1, recipient_keyid = 1,
dhy = 16#b609d7fc8b595ce414a0b644d11b1e0547d65e60144308d97d02d3ae477c1ffaa778de041661fe950440de547177eb55560dddea9bb388044d54b2c1fa6ef617777337ea45086b1c2b764d96a1d58cc778874395d92ab08099f3026159e3319610dc85a7f0b2527bee8b31d18e4c647c37d277ec96ef8b04cfecf7768808deb15c6f68ca4645a8089445d0cf895a1dcbd2d8442907bc5b407ac4fcc0bae1020d9efd24a3bbb96afcb6981c536e7ec809080a95940542c43b45e383e1efd15a29,
ctr_init = << 16#00, 16#00, 16#00, 16#00, 16#00, 16#00, 16#00, 16#01 >>,
enc_data = << 16#c8, 16#0f, 16#7a, 16#cb, 16#0d, 16#0d, 16#3c, 16#a1, 16#84, 16#5c, 16#64, 16#22, 16#74, 16#7e, 16#65, 16#9f, 16#18, 16#a2, 16#9a, 16#b2, 16#cd, 16#19, 16#56, 16#ad, 16#c0, 16#e1, 16#67, 16#3e, 16#86, 16#6a, 16#3c, 16#5b, 16#17, 16#e3, 16#a1, 16#88, 16#7a, 16#e4, 16#1f, 16#d1, 16#44, 16#eb, 16#37, 16#47, 16#94, 16#ba, 16#13, 16#67, 16#bf, 16#60, 16#92, 16#7a, 16#28, 16#7d, 16#b8, 16#70, 16#92, 16#a6, 16#2b, 16#74, 16#fa, 16#0f, 16#b0, 16#14, 16#56, 16#40, 16#7d, 16#0f, 16#8d, 16#26, 16#fe, 16#06, 16#7f, 16#82, 16#29, 16#d3, 16#96, 16#91, 16#42, 16#9b, 16#b9, 16#04, 16#c6, 16#01, 16#9a, 16#8e, 16#13, 16#7e, 16#32, 16#21, 16#0e, 16#bd, 16#e4, 16#9f, 16#3a, 16#cd, 16#dc, 16#ee, 16#a3, 16#46, 16#3a, 16#06, 16#dc, 16#95, 16#5a, 16#cc, 16#52, 16#36, 16#a7, 16#ec, 16#ad, 16#09, 16#bd, 16#d0, 16#72, 16#23, 16#07, 16#5e, 16#3b, 16#bf, 16#7c, 16#f9, 16#6f, 16#cf, 16#d2, 16#cb, 16#5a, 16#5d, 16#33, 16#27, 16#35, 16#39, 16#c3, 16#fb, 16#aa, 16#78, 16#1f, 16#68, 16#ef, 16#01, 16#4a, 16#97, 16#96, 16#da, 16#44, 16#8c, 16#36, 16#87, 16#d8, 16#b1, 16#63, 16#2b, 16#26, 16#c1, 16#f5, 16#48, 16#ce, 16#96, 16#bd, 16#dd, 16#85, 16#e4, 16#53, 16#0e, 16#54, 16#fd, 16#7a, 16#04, 16#9e, 16#eb, 16#63, 16#ba, 16#f5, 16#a1, 16#d6, 16#1c, 16#1e, 16#69, 16#69, 16#53, 16#42, 16#4c, 16#ad, 16#08, 16#00, 16#5c, 16#12, 16#d3, 16#ac, 16#4f, 16#a8, 16#ba, 16#10, 16#cc, 16#40, 16#e1, 16#c8, 16#f5, 16#95, 16#5b, 16#0b, 16#76, 16#88, 16#25, 16#ca, 16#df, 16#99, 16#a4, 16#b7, 16#ae, 16#fb, 16#4e, 16#37, 16#93, 16#07, 16#e1, 16#b4, 16#0d, 16#66, 16#d1, 16#b3, 16#24, 16#e6, 16#43, 16#24, 16#ae, 16#47, 16#90, 16#05, 16#42, 16#b5, 16#61, 16#a2, 16#be, 16#1f, 16#d8, 16#b2, 16#56, 16#b1, 16#db, 16#ab, 16#d2, 16#7b, 16#21, 16#10, 16#ae, 16#e2, 16#0e, 16#d9, 16#45, 16#8b, 16#13, 16#95, 16#03, 16#d3, 16#8f, 16#71, 16#e4, 16#6f, 16#12, 16#5b, 16#c0 >>,
mac = << 16#f9, 16#1b, 16#87, 16#ab, 16#dd, 16#58, 16#8b, 16#88, 16#a3, 16#89, 16#c8, 16#e7, 16#d9, 16#62, 16#dd, 16#a7, 16#03, 16#b8, 16#a5, 16#4c >>,
old_mac_keys = <<>>}
}). %}}}F

-define(MessageTestVector6, { %F{{{
"?OTR:AAIDAAAAAAIAAAADAAAAwB6loY8bWWoFQLVjYN/x6tvFjJIGH0Ujeosnq9nQSKbA8kM+9koQej6Xykd9YhKgAHBjj9UPAXfLy24LUzMTL7d7S/zgzl5tOD81JLWuYnmxQ9matfSu2Qa3HY4lLU5nIwUamXp0OP3oMV49Zpld5FSqvBK3ASyk36Vbrv1213zPc9JTpAPA28sEAfwa3A96888jCv2OKVSD8OCmxXFBN1nFpe+CfaI8xlz7RAdCX2AqJ8xK8RJoD5XM8Jre2bLBKAAAAAAAAAABAAAANWAZHVRZp7c/rKcz5T+iF5RSwHrBV6q4YDp07WbISActZR7h9jDWdK1ow7UMXmJFKmJWypc90y84NcyOYb5/BcIcq/9ZCuDY3tEAAAAUQ6Jv6nG8X5HnleK3ksLYkowMVxA=.",
#otr_msg_data{flags = 0, sender_keyid = 2, recipient_keyid = 3,
dhy = 16#1ea5a18f1b596a0540b56360dff1eadbc58c92061f45237a8b27abd9d048a6c0f2433ef64a107a3e97ca477d6212a00070638fd50f0177cbcb6e0b5333132fb77b4bfce0ce5e6d383f3524b5ae6279b143d99ab5f4aed906b71d8e252d4e6723051a997a7438fde8315e3d66995de454aabc12b7012ca4dfa55baefd76d77ccf73d253a403c0dbcb0401fc1adc0f7af3cf230afd8e295483f0e0a6c571413759c5a5ef827da23cc65cfb4407425f602a27cc4af112680f95ccf09aded9b2c128,
ctr_init = << 16#00, 16#00, 16#00, 16#00, 16#00, 16#00, 16#00, 16#01 >>,
enc_data = << 16#60, 16#19, 16#1d, 16#54, 16#59, 16#a7, 16#b7, 16#3f, 16#ac, 16#a7, 16#33, 16#e5, 16#3f, 16#a2, 16#17, 16#94, 16#52, 16#c0, 16#7a, 16#c1, 16#57, 16#aa, 16#b8, 16#60, 16#3a, 16#74, 16#ed, 16#66, 16#c8, 16#48, 16#07, 16#2d, 16#65, 16#1e, 16#e1, 16#f6, 16#30, 16#d6, 16#74, 16#ad, 16#68, 16#c3, 16#b5, 16#0c, 16#5e, 16#62, 16#45, 16#2a, 16#62, 16#56, 16#ca, 16#97, 16#3d >>,
mac = <<16#d3, 16#2f, 16#38, 16#35, 16#cc, 16#8e, 16#61, 16#be, 16#7f, 16#05, 16#c2, 16#1c, 16#ab, 16#ff, 16#59, 16#0a, 16#e0, 16#d8, 16#de, 16#d1>>,
old_mac_keys = << 16#43, 16#a2, 16#6f, 16#ea, 16#71, 16#bc, 16#5f, 16#91, 16#e7, 16#95, 16#e2, 16#b7, 16#92, 16#c2, 16#d8, 16#92, 16#8c, 16#0c, 16#57, 16#10>>
}
}). %}}}F

-define(MessageTestVector7, { %F{{{
512,
["?OTR,1,4,?OTR:AAIDAAAAAAEAAAABAAAAwAl6JpwVxP0v0jgRfdywh9MVZROHu6gkI/k9evkLOTC4w+kfoo+876q8GECZd/dC2GHGE4ttZRRUKSqAmaiIBD0s6BsFd23rrfch0zpiGlqcDSB20NepIDiv9TOAXysG/0k2zHPQuKmWuejRIB5BsMVRV/YvQ818Vuc4em0gB50VVG25VqjtZyrkLlEj0XC0vpPoh1JayDNsevSadlhJ1RDex4D9q/A+4FXmpwuJauECmbfltQYnaq6OwxmNYhJibQAAAAAAAAABAAADsFh6qVQ5Xu8brGhRRV/wCKTCBEEEWt0OliXDUF0156RcYlJsR+A2XrYZVbELei1bXT5B9YKMW8+tfgw6RtcLZb4e1IiiZFqoHcyV8dY6kAGGKvLlGLuN/7s2HXJDC3hDNNX78MYdx2wVc5t9faMwKNLdj4HPqzuz5tAcfksc4/eFtZ7a7El9Fd0pUDUz3QdYJh5/aerQlNZJlSXcnATvJ6I,",
             "?OTR,2,4,8GYjaaCOM84PZHLxL270mnwYwkAukXcQP/dVLBfNK7NxEzei0/4OOYxLwA4gWP+hkEdIbhRN27wgZAXGn3wTCviiNfQGwG8B8OQ3z79lKloAtaUPlkqFYSdX6RTbHgs6uHreRdoUb3G15kOz9EgMgryS5YcJQCC9MIxL6ctOqsgfY/sWHVH0NbuTOGfVJEqfHXddZ+pmmvzNglnhGQuv8g3HlmwTBjwg+gV1RTO0ODjSNqqVmetfq+lzuR9+NaAZgeW7Il38+2ftIWhkvbzMb5h+1gztMHxaJrldI434X8Ox86s0pCYklpWHziyxuJiEpH1vehzZvI1GONq/YNZbRMJmS5HIZJ15iiXbsbKV57wKxdrBkjGsnfxoPjtNoho/mm6I7nukHEYhs9OQOF0Jx110WkCC9c6CVPsLDucGOefZVDSasYL+T4T+GlpxnhkfRAtNw8k7Pq+hMD6n6ySWlxc3SyM3nyfRdURS+lqnfzrgzp2FJDbON0B/By2gbVa4,",
             "?OTR,3,4,lUIyOs0n8rsdXwhOH/7+kB6fSktMbDJuOFEy/EmAQ8+SsP6eTCCg6OkZQe4P/lNX0saT3mb0PXgdR+lFbBPMXYyFuDEdY3U16XjiAGkv4/iMV27A4fwM5oyI3NH93MqyYEj0YnAvDsEAgMZgB5pxj/eciEv2hURk+88pczWa7VTWRjdTCS48hAj4WymZGMpKiq9xChWI7qCnB+X/j/h5ibYslMU8Gj6deJZ/W/gxw64Ll+mCeGPPLWQweOSTlVan8ZTc5Q3TK7pyefW9tDhEw2Wco7GdcwfX5Cr3jsKHIL6RyGOu/sDkfbr9yVQnUvoTjitAyICGrp5oiWBj+aPJEhY6Bx0Vr5apfzZGrM230uZymFknqnyu/BQ9Y9w/1niifZji9F2jfPgbht4JKpYIf/XwEv+lZdmRx5aVqDgJrlIvM7bF/SuzhkZFGmHpVfN3wGRxTMafcIEpA+8+QM0wPezVlrAtKfsFSjHWaeVEKEfhqyS3dUWBvSNj0WsKgQjV,",
             "?OTR,4,4,WiDrxyYLwyQ9DEeZtiAD+NDQnM7dh7sHeQssY36pS4UQukbUAAAAA.,"],
#otr_msg_data{flags = 0, sender_keyid = 1, recipient_keyid = 1,
dhy = 16#097a269c15c4fd2fd238117ddcb087d315651387bba82423f93d7af90b3930b8c3e91fa28fbcefaabc18409977f742d861c6138b6d651454292a8099a888043d2ce81b05776debadf721d33a621a5a9c0d2076d0d7a92038aff533805f2b06ff4936cc73d0b8a996b9e8d1201e41b0c55157f62f43cd7c56e7387a6d20079d15546db956a8ed672ae42e5123d170b4be93e887525ac8336c7af49a765849d510dec780fdabf03ee055e6a70b896ae10299b7e5b506276aae8ec3198d6212626d,
ctr_init = << 16#00, 16#00, 16#00, 16#00, 16#00, 16#00, 16#00, 16#01 >>,
enc_data = << 16#58, 16#7a, 16#a9, 16#54, 16#39, 16#5e, 16#ef, 16#1b, 16#ac, 16#68, 16#51, 16#45, 16#5f, 16#f0, 16#08, 16#a4, 16#c2, 16#04, 16#41, 16#04, 16#5a, 16#dd, 16#0e, 16#96, 16#25, 16#c3, 16#50, 16#5d, 16#35, 16#e7, 16#a4, 16#5c, 16#62, 16#52, 16#6c, 16#47, 16#e0, 16#36, 16#5e, 16#b6, 16#19, 16#55, 16#b1, 16#0b, 16#7a, 16#2d, 16#5b, 16#5d, 16#3e, 16#41, 16#f5, 16#82, 16#8c, 16#5b, 16#cf, 16#ad, 16#7e, 16#0c, 16#3a, 16#46, 16#d7, 16#0b, 16#65, 16#be, 16#1e, 16#d4, 16#88, 16#a2, 16#64, 16#5a, 16#a8, 16#1d, 16#cc, 16#95, 16#f1, 16#d6, 16#3a, 16#90, 16#01, 16#86, 16#2a, 16#f2, 16#e5, 16#18, 16#bb, 16#8d, 16#ff, 16#bb, 16#36, 16#1d, 16#72, 16#43, 16#0b, 16#78, 16#43, 16#34, 16#d5, 16#fb, 16#f0, 16#c6, 16#1d, 16#c7, 16#6c, 16#15, 16#73, 16#9b, 16#7d, 16#7d, 16#a3, 16#30, 16#28, 16#d2, 16#dd, 16#8f, 16#81, 16#cf, 16#ab, 16#3b, 16#b3, 16#e6, 16#d0, 16#1c, 16#7e, 16#4b, 16#1c, 16#e3, 16#f7, 16#85, 16#b5, 16#9e, 16#da, 16#ec, 16#49, 16#7d, 16#15, 16#dd, 16#29, 16#50, 16#35, 16#33, 16#dd, 16#07, 16#58, 16#26, 16#1e, 16#7f, 16#69, 16#ea, 16#d0, 16#94, 16#d6, 16#49, 16#95, 16#25, 16#dc, 16#9c, 16#04, 16#ef, 16#27, 16#a2, 16#3c, 16#19, 16#88, 16#da, 16#68, 16#23, 16#8c, 16#f3, 16#83, 16#d9, 16#1c, 16#bc, 16#4b, 16#db, 16#bd, 16#26, 16#9f, 16#06, 16#30, 16#90, 16#0b, 16#a4, 16#5d, 16#c4, 16#0f, 16#fd, 16#d5, 16#4b, 16#05, 16#f3, 16#4a, 16#ec, 16#dc, 16#44, 16#cd, 16#e8, 16#b4, 16#ff, 16#83, 16#8e, 16#63, 16#12, 16#f0, 16#03, 16#88, 16#16, 16#3f, 16#e8, 16#64, 16#11, 16#d2, 16#1b, 16#85, 16#13, 16#76, 16#ef, 16#08, 16#19, 16#01, 16#71, 16#a7, 16#df, 16#04, 16#c2, 16#be, 16#28, 16#8d, 16#7d, 16#01, 16#b0, 16#1b, 16#c0, 16#7c, 16#39, 16#0d, 16#f3, 16#ef, 16#d9, 16#4a, 16#96, 16#80, 16#2d, 16#69, 16#43, 16#e5, 16#92, 16#a1, 16#58, 16#49, 16#d5, 16#fa, 16#45, 16#36, 16#c7, 16#82, 16#ce, 16#ae, 16#1e, 16#b7, 16#91, 16#76, 16#85, 16#1b, 16#dc, 16#6d, 16#79, 16#90, 16#ec, 16#fd, 16#12, 16#03, 16#20, 16#af, 16#24, 16#b9, 16#61, 16#c2, 16#50, 16#08, 16#2f, 16#4c, 16#23, 16#12, 16#fa, 16#72, 16#d3, 16#aa, 16#b2, 16#07, 16#d8, 16#fe, 16#c5, 16#87, 16#54, 16#7d, 16#0d, 16#6e, 16#e4, 16#ce, 16#19, 16#f5, 16#49, 16#12, 16#a7, 16#c7, 16#5d, 16#d7, 16#59, 16#fa, 16#99, 16#a6, 16#bf, 16#33, 16#60, 16#96, 16#78, 16#46, 16#42, 16#eb, 16#fc, 16#83, 16#71, 16#e5, 16#9b, 16#04, 16#c1, 16#8f, 16#08, 16#3e, 16#81, 16#5d, 16#51, 16#4c, 16#ed, 16#0e, 16#0e, 16#34, 16#8d, 16#aa, 16#a5, 16#66, 16#7a, 16#d7, 16#ea, 16#fa, 16#5c, 16#ee, 16#47, 16#df, 16#8d, 16#68, 16#06, 16#60, 16#79, 16#6e, 16#c8, 16#97, 16#7f, 16#3e, 16#d9, 16#fb, 16#48, 16#5a, 16#19, 16#2f, 16#6f, 16#33, 16#1b, 16#e6, 16#1f, 16#b5, 16#83, 16#3b, 16#4c, 16#1f, 16#16, 16#89, 16#ae, 16#57, 16#48, 16#e3, 16#7e, 16#17, 16#f0, 16#ec, 16#7c, 16#ea, 16#cd, 16#29, 16#09, 16#89, 16#25, 16#a5, 16#61, 16#f3, 16#8b, 16#2c, 16#6e, 16#26, 16#21, 16#29, 16#1f, 16#5b, 16#de, 16#87, 16#36, 16#6f, 16#23, 16#51, 16#8e, 16#36, 16#af, 16#d8, 16#35, 16#96, 16#d1, 16#30, 16#99, 16#92, 16#e4, 16#72, 16#19, 16#27, 16#5e, 16#62, 16#89, 16#76, 16#ec, 16#6c, 16#a5, 16#79, 16#ef, 16#02, 16#b1, 16#76, 16#b0, 16#64, 16#8c, 16#6b, 16#27, 16#7f, 16#1a, 16#0f, 16#8e, 16#d3, 16#68, 16#86, 16#8f, 16#e6, 16#9b, 16#a2, 16#3b, 16#9e, 16#e9, 16#07, 16#11, 16#88, 16#6c, 16#f4, 16#e4, 16#0e, 16#17, 16#42, 16#71, 16#d7, 16#5d, 16#16, 16#90, 16#20, 16#bd, 16#73, 16#a0, 16#95, 16#3e, 16#c2, 16#c3, 16#b9, 16#c1, 16#8e, 16#79, 16#f6, 16#55, 16#0d, 16#26, 16#ac, 16#60, 16#bf, 16#93, 16#e1, 16#3f, 16#86, 16#96, 16#9c, 16#67, 16#86, 16#47, 16#d1, 16#02, 16#d3, 16#70, 16#f2, 16#4e, 16#cf, 16#ab, 16#e8, 16#4c, 16#0f, 16#a9, 16#fa, 16#c9, 16#25, 16#a5, 16#c5, 16#cd, 16#d2, 16#c8, 16#cd, 16#e7, 16#c9, 16#f4, 16#5d, 16#51, 16#14, 16#be, 16#96, 16#a9, 16#df, 16#ce, 16#b8, 16#33, 16#a7, 16#61, 16#49, 16#0d, 16#b3, 16#8d, 16#d0, 16#1f, 16#c1, 16#cb, 16#68, 16#1b, 16#55, 16#ae, 16#25, 16#50, 16#8c, 16#8e, 16#b3, 16#49, 16#fc, 16#ae, 16#c7, 16#57, 16#c2, 16#13, 16#87, 16#ff, 16#bf, 16#a4, 16#07, 16#a7, 16#d2, 16#92, 16#d3, 16#1b, 16#0c, 16#9b, 16#8e, 16#14, 16#4c, 16#bf, 16#12, 16#60, 16#10, 16#f3, 16#e4, 16#ac, 16#3f, 16#a7, 16#93, 16#08, 16#28, 16#3a, 16#3a, 16#46, 16#50, 16#7b, 16#83, 16#ff, 16#94, 16#d5, 16#f4, 16#b1, 16#a4, 16#f7, 16#99, 16#bd, 16#0f, 16#5e, 16#07, 16#51, 16#fa, 16#51, 16#5b, 16#04, 16#f3, 16#17, 16#63, 16#21, 16#6e, 16#0c, 16#47, 16#58, 16#dd, 16#4d, 16#7a, 16#5e, 16#38, 16#80, 16#1a, 16#4b, 16#f8, 16#fe, 16#23, 16#15, 16#db, 16#b0, 16#38, 16#7f, 16#03, 16#39, 16#a3, 16#22, 16#37, 16#34, 16#7f, 16#77, 16#32, 16#ac, 16#98, 16#12, 16#3d, 16#18, 16#9c, 16#0b, 16#c3, 16#b0, 16#40, 16#20, 16#31, 16#98, 16#01, 16#e6, 16#9c, 16#63, 16#fd, 16#e7, 16#22, 16#12, 16#fd, 16#a1, 16#51, 16#19, 16#3e, 16#f3, 16#ca, 16#5c, 16#cd, 16#66, 16#bb, 16#55, 16#35, 16#91, 16#8d, 16#d4, 16#c2, 16#4b, 16#8f, 16#21, 16#02, 16#3e, 16#16, 16#ca, 16#66, 16#46, 16#32, 16#92, 16#a2, 16#ab, 16#dc, 16#42, 16#85, 16#62, 16#3b, 16#a8, 16#29, 16#c1, 16#f9, 16#7f, 16#e3, 16#fe, 16#1e, 16#62, 16#6d, 16#8b, 16#25, 16#31, 16#4f, 16#06, 16#8f, 16#a7, 16#5e, 16#25, 16#9f, 16#d6, 16#fe, 16#0c, 16#70, 16#eb, 16#82, 16#e5, 16#fa, 16#60, 16#9e, 16#18, 16#f3, 16#cb, 16#59, 16#0c, 16#1e, 16#39, 16#24, 16#e5, 16#55, 16#a9, 16#fc, 16#65, 16#37, 16#39, 16#43, 16#74, 16#ca, 16#ee, 16#9c, 16#9e, 16#7d, 16#6f, 16#6d, 16#0e, 16#11, 16#30, 16#d9, 16#67, 16#28, 16#ec, 16#67, 16#5c, 16#c1, 16#f5, 16#f9, 16#0a, 16#bd, 16#e3, 16#b0, 16#a1, 16#c8, 16#2f, 16#a4, 16#72, 16#18, 16#eb, 16#bf, 16#b0, 16#39, 16#1f, 16#6e, 16#bf, 16#72, 16#55, 16#09, 16#d4, 16#be, 16#84, 16#e3, 16#8a, 16#d0, 16#32, 16#20, 16#21, 16#ab, 16#a7, 16#9a, 16#22, 16#58, 16#18, 16#fe, 16#68, 16#f2, 16#44, 16#85, 16#8e, 16#81, 16#c7, 16#45, 16#6b, 16#e5, 16#aa, 16#5f, 16#cd, 16#91, 16#ab, 16#33, 16#6d, 16#f4, 16#b9, 16#9c, 16#a6, 16#16, 16#49, 16#ea, 16#9f, 16#2b, 16#bf, 16#05, 16#0f, 16#58, 16#f7, 16#0f, 16#f5, 16#9e, 16#28, 16#9f, 16#66, 16#38, 16#bd, 16#17, 16#68, 16#df, 16#3e, 16#06, 16#e1, 16#b7, 16#82, 16#4a, 16#a5, 16#82, 16#1f, 16#fd, 16#7c, 16#04, 16#bf, 16#e9, 16#59, 16#76, 16#64, 16#71, 16#e5, 16#a5, 16#6a, 16#0e, 16#02, 16#6b, 16#94, 16#8b, 16#cc, 16#ed, 16#b1, 16#7f, 16#4a, 16#ec, 16#e1, 16#91, 16#91, 16#46, 16#98, 16#7a, 16#55, 16#7c, 16#dd, 16#f0, 16#19, 16#1c, 16#53, 16#31, 16#a7, 16#dc, 16#20, 16#4a, 16#40, 16#fb, 16#cf, 16#90, 16#33, 16#4c, 16#0f, 16#7b, 16#35, 16#65, 16#ac, 16#0b, 16#4a, 16#7e, 16#c1, 16#52, 16#8c, 16#75, 16#9a, 16#79, 16#51, 16#0a, 16#11, 16#f8, 16#6a, 16#c9, 16#2d, 16#dd, 16#51, 16#60, 16#6f, 16#48, 16#d8, 16#f4, 16#5a, 16#c2, 16#a0, 16#42, 16#35, 16#56, 16#88, 16#3a, 16#f1, 16#c9, 16#82, 16#f0, 16#c9, 16#0f, 16#43, 16#11, 16#e6, 16#6d, 16#88, 16#00, 16#fe>>,
mac = << 16#34, 16#34, 16#27, 16#33, 16#b7, 16#61, 16#ee, 16#c1, 16#de, 16#42, 16#cb, 16#18, 16#df, 16#aa, 16#52, 16#e1, 16#44, 16#2e, 16#91, 16#b5>>,
old_mac_keys = <<>>}
}). %}}}F
